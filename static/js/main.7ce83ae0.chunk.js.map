{"version":3,"sources":["components/ScanBarcodeButton.js","utils/supabaseClient.js","hook/useSupabaseData.js","components/AddProductForm.js","components/AddProductInventoryForm.js","components/ProductItem.js","components/ShoppingListItem.js","hook/useListaCompra.js","components/ExpiredProductItem.js","hook/useCaducados.js","components/SettingsModal.js","components/ProductSearchBar.js","App.js","index.js"],"names":["ScanBarcodeButton","_ref","onScan","isScanning","setIsScanning","useState","status","setStatus","facingMode","setFacingMode","videoRef","useRef","beepSound","Audio","startScanner","setTimeout","Quagga","init","inputStream","type","target","current","document","querySelector","constraints","width","height","decoder","readers","err","console","error","start","onDetected","handleDetected","stopScanner","offDetected","stop","result","code","codeResult","concat","play","catch","e","log","useEffect","React","createElement","className","onClick","toggleCamera","title","ref","id","supabase","createClient","useSupabaseData","table","data","setData","loading","setLoading","async","from","select","fetchData","AddProductForm","_product$name","_product$barcode","_product$quantity","_product$category","_product$location","_product$expiryDate","onProductAdded","Inventario","product","setProduct","name","barcode","quantity","category","location","expiryDate","categorias","ubicaciones","eq","limit","message","length","existente","prev","_objectSpread","nombre","categoria_id","ubicacion_id","fecha_caducidad","buscarProductoPorCodigo","handleChange","value","qty","parseInt","[object Object]","onSubmit","preventDefault","productoParaGuardar","codigo_barras","cantidad","productoCatalogo","errorCatalogo","errorInsertarCatalogo","insert","alert","updateError","update","existentes","fetchError","productoExistente","nuevaCantidad","insertError","onChange","required","min","map","cat","key","ubi","AddProductInventoryForm","codigoInicial","loadingCatalog","setLoadingCatalog","productoEnCatalogo","setProductoEnCatalogo","trim","single","buscarEnCatalogo","errorBuscar","errorUpdate","errorInsert","placeholder","ProductItem","_product$categorias","_product$ubicaciones","onEdit","onDelete","onAddToShoppingList","onTogglePlus","onToggleMinus","daysLeft","calculateDaysLeft","diffTime","Date","Math","ceil","statusClass","statusText","toLocaleDateString","ShoppingListItem","onTogglePurchased","lista","useListaCompra","setLista","order","ascending","fetchLista","ExpiredProductItem","caducados","useCaducados","setCaducados","fetchCaducados","toISOString","split","dataCaducados","errorCaducados","SettingsModal","isOpen","onClose","newCategoria","setNewCategoria","newUbicacion","setNewUbicacion","setCategorias","setUbicaciones","categoriasData","ubicacionesData","delete","deleteCategoria","deleteUbicacion","ProductSearchBar","onResults","query","setQuery","categoriaId","setCategoriaId","ubicacionId","setUbicacionId","fetchFilters","handleSearch","cleanedQuery","queryBase","or","productos","enCatalogo","style","position","display","alignItems","onKeyDown","handleClear","right","background","border","cursor","fontSize","color","c","u","App","products","setProducts","shoppingList","setShoppingList","expiredProducts","setExpiredProducts","activeTab","setActiveTab","showAddForm","setShowAddForm","editingProduct","setEditingProduct","showAddInventoryForm","setShowAddInventoryForm","editingProductShopping","setEditingProductShopping","codigoEscaneado","setCodigoEscaneado","fetchProducts","fetchExpiredProducts","fetchShoppingList","revisarProductosCaducados","now","filter","p","producto","nuevoId","toString","categoriaData","ubicacionData","existe","errorExiste","maybeSingle","es_caducado","handleEditProduct","window","scrollTo","top","behavior","handleDeleteProduct","productId","prevProducts","setSearchResults","setCatalogMatch","handleDeleteExpiredProduct","handleAddToShoppingList","item","_p$cantidad","_p$codigo_barras","_p$fecha_caducidad","_p$categoria_id","_p$categorias","_ref2","_p$ubicacion_id","_p$ubicaciones","normalizarProductoParaLista","handleTogglePurchased","i","handleAddQuantity","handleSubstractQuantity","handleAddQuantityInventario","searchResults","nuevosResultados","handleSubstractQuantityInventario","mostrarAjustes","setMostrarAjustes","catalogMatch","searchTerm","setSearchTerm","buscarVacio","setBuscarVacio","timer","clearTimeout","Fragment","resultados","catalogoArray","termino","Array","isArray","newProduct","prod","createRoot","getElementById","render"],"mappings":"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","file":"static/js/main.7ce83ae0.chunk.js","sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport Quagga from 'quagga';\n\nconst ScanBarcodeButton = ({ onScan }) => {\n  const [isScanning, setIsScanning] = useState(false);\n  const [status, setStatus] = useState('');\n  const [facingMode, setFacingMode] = useState('environment'); // üëà Estado para c√°mara\n  const videoRef = useRef(null);\n\n  const beepSound = new Audio('scanner-beep.mp3'); // si est√° en /public\n\n  const startScanner = () => {\n    setIsScanning(true);\n    setStatus('Iniciando esc√°ner...');\n\n    setTimeout(() => {\n      Quagga.init({\n        inputStream: {\n          type: 'LiveStream',\n          target: videoRef.current || document.querySelector('#video'),\n          constraints: {\n            width: 640,\n            height: 480,\n            facingMode: facingMode // üëà Usa estado din√°mico\n          }\n        },\n        decoder: {\n          readers: ['ean_reader', 'code_128_reader', 'upc_reader']\n        }\n      }, (err) => {\n        if (err) {\n          console.error(err);\n          setStatus('Error al iniciar el esc√°ner');\n          return;\n        }\n        Quagga.start();\n        setStatus('Escaneando...');\n      });\n\n      Quagga.onDetected(handleDetected);\n    }, 500);\n  };\n\n  const stopScanner = () => {\n    Quagga.offDetected(handleDetected);\n    Quagga.stop();\n    setIsScanning(false);\n    setStatus('');\n  };\n\n  const toggleCamera = () => {\n    const nuevoModo = facingMode === 'environment' ? 'user' : 'environment';\n    setFacingMode(nuevoModo);\n\n    // Reiniciar esc√°ner con nueva c√°mara\n    if (isScanning) {\n      stopScanner();\n      setTimeout(startScanner, 500);\n    }\n  };\n\n  const handleDetected = (result) => {\n    const code = result.codeResult.code;\n    setStatus(`C√≥digo detectado: ${code}`);\n    onScan(code);\n    beepSound.play().catch(e => console.log('üîá No se pudo reproducir el sonido:', e));\n    stopScanner();\n  };\n\n  useEffect(() => {\n    return () => {\n      if (isScanning) stopScanner();\n    };\n  }, [isScanning]);\n\n  return (\n    <div className=\"relative\">\n      <button \n        onClick={isScanning ? stopScanner : startScanner}\n        className={`py-2 px-4 rounded-lg transition-colors ${\n          isScanning \n            ? 'bg-red-500 hover:bg-red-600 text-white'\n            : 'bg-blue-500 hover:bg-blue-600 text-white'\n        }`}\n      >\n        {isScanning ? 'Cancelar Escaneo' : 'Escanear C√≥digo'}\n      </button>\n\n      <div className=\"text-sm text-gray-600 mt-1\">{status}</div>\n\n      {isScanning && (\n        <div className=\"fixed inset-0 bg-black z-50 flex flex-col items-center justify-center p-4\">\n          <div className=\"w-full max-w-md\">\n            <div className=\"flex justify-between items-center mb-2\">\n              <h2 className=\"text-lg font-bold text-white\">Esc√°ner de c√≥digos</h2>\n              <div className=\"flex gap-2\">\n                <button\n                  onClick={toggleCamera}\n                  className=\"text-white text-xl p-2\"\n                  title=\"Cambiar c√°mara\"\n                >\n                  üîÅ\n                </button>\n                <button \n                  onClick={stopScanner}\n                  className=\"text-white text-xl p-2\"\n                  title=\"Cerrar esc√°ner\"\n                >\n                  ‚úï\n                </button>\n              </div>\n            </div>\n\n            <div\n              ref={videoRef}\n              className=\"relative w-full h-64 bg-black rounded-lg overflow-hidden\"\n              id=\"video\"\n            >\n              <div className=\"absolute top-0 left-0 right-0 bottom-0 flex items-center justify-center\">\n                <div className=\"border-2 border-red-400 w-64 h-40 relative\">\n                  <div className=\"absolute -top-1 -left-1 w-4 h-4 border-t-2 border-l-2 border-red-400\"></div>\n                  <div className=\"absolute -top-1 -right-1 w-4 h-4 border-t-2 border-r-2 border-red-400\"></div>\n                  <div className=\"absolute -bottom-1 -left-1 w-4 h-4 border-b-2 border-l-2 border-red-400\"></div>\n                  <div className=\"absolute -bottom-1 -right-1 w-4 h-4 border-b-2 border-r-2 border-red-400\"></div>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"mt-4 text-center text-white\">\n              <p>Enfoca el c√≥digo de barras dentro del cuadro</p>\n              <p className=\"text-yellow-300 font-medium mt-2\">{status}</p>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ScanBarcodeButton;\n","import { createClient } from '@supabase/supabase-js';\r\n\r\nconst supabaseUrl = 'https://qhfungoeldemkcnpqaiu.supabase.co';\r\nconst supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFoZnVuZ29lbGRlbWtjbnBxYWl1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg0OTIxNDEsImV4cCI6MjA2NDA2ODE0MX0.Cyy4kZm1rGvgez19hZWY1qQ7JwxcF__doLMqYl6Qa9E';\r\nexport const supabase = createClient(supabaseUrl, supabaseKey);\r\n","// src/hooks/useSupabaseData.js\r\nimport { useEffect, useState } from 'react';\r\nimport { supabase } from '../utils/supabaseClient';\r\n\r\nexport const useSupabaseData = (table) => {\r\n  const [data, setData] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      const { data, error } = await supabase.from(table).select('*');\r\n      if (error) console.error(error);\r\n      else setData(data);\r\n      setLoading(false);\r\n    };\r\n    fetchData();\r\n  }, [table]);\r\n\r\n  return { data, loading };\r\n};\r\n","import React, { useState, useEffect } from 'react';\nimport { supabase } from '../utils/supabaseClient';\nimport { useSupabaseData } from '../hook/useSupabaseData';\n\nconst AddProductForm = ({ onProductAdded, Inventario = null }) => {\n  const [product, setProduct] = useState(Inventario || {\n    id: '',\n    name: '',\n    barcode: '',\n    quantity: 1,\n    category: '',\n    location: '',\n    expiryDate: ''\n  });\n\n  const { data: categorias } = useSupabaseData('categorias');\n  const { data: ubicaciones } = useSupabaseData('ubicaciones');\n\n  useEffect(() => {\n    const buscarProductoPorCodigo = async () => {\n      if (!product.barcode) return;\n\n      const { data, error } = await supabase\n        .from('catalogo_productos')\n        .select('*')\n        .eq('codigo_barras', product.barcode)\n        .limit(1);\n\n      if (error) {\n        console.error('Error buscando por c√≥digo de barras:', error.message);\n        return;\n      }\n\n      if (data.length > 0) {\n        const existente = data[0];\n        setProduct(prev => ({\n          ...prev,\n          name: existente.nombre,\n          category: existente.categoria_id,\n          location: existente.ubicacion_id,\n          expiryDate: existente.fecha_caducidad\n        }));\n      }\n    };\n\n    buscarProductoPorCodigo();\n  }, [product.barcode]);\n\n  const handleChange = (e) => {\n    const { name, value } = e.target;\n    if (name === 'quantity') {\n      const qty = value === '' ? '' : parseInt(value, 10);\n      setProduct(prev => ({ ...prev, quantity: qty }));\n    } else {\n      setProduct(prev => ({ ...prev, [name]: value }));\n    }\n\n    {/*setProduct(prev => ({\n      ...prev,\n      [name]: name === 'quantity' ? parseInt(value) : value\n    }));*/}\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    const productoParaGuardar = {\n      nombre: product.name,\n      codigo_barras: product.barcode,\n      fecha_caducidad: product.expiryDate,\n      categoria_id: product.category,\n      ubicacion_id: product.location,\n      cantidad: product.quantity\n    };\n\n    // Insertar en cat√°logo si no existe\n    const { data: productoCatalogo, error: errorCatalogo } = await supabase\n      .from('catalogo_productos')\n      .select('*')\n      .eq('codigo_barras', productoParaGuardar.codigo_barras)\n      .limit(1);\n\n    if (errorCatalogo) {\n      console.error('‚ùå Error consultando cat√°logo:', errorCatalogo.message);\n    }\n\n    if (!productoCatalogo || productoCatalogo.length === 0) {\n      const { error: errorInsertarCatalogo } = await supabase\n        .from('catalogo_productos')\n        .insert([{\n          nombre: productoParaGuardar.nombre,\n          codigo_barras: productoParaGuardar.codigo_barras,\n        }]);\n\n      if (errorInsertarCatalogo) {\n        console.error('‚ùå Error al insertar en cat√°logo:', errorInsertarCatalogo.message);\n        alert('‚ùå No se pudo guardar el producto en el cat√°logo');\n        return;\n      }\n    }\n\n    if (Inventario && Inventario.id) {\n      // Modo edici√≥n ‚Üí actualizar cantidad directamente\n      const { error: updateError } = await supabase\n        .from('productos')\n        .update({\n          nombre: productoParaGuardar.nombre,\n          codigo_barras: productoParaGuardar.codigo_barras,\n          fecha_caducidad: productoParaGuardar.fecha_caducidad,\n          categoria_id: productoParaGuardar.categoria_id,\n          ubicacion_id: productoParaGuardar.ubicacion_id,\n          cantidad: productoParaGuardar.cantidad\n        })\n        .eq('id', Inventario.id);\n\n      if (updateError) {\n        console.error('‚ùå Error al actualizar producto:', updateError.message);\n        alert('‚ùå Error al actualizar el producto');\n        return;\n      }\n\n      alert('‚úÖ Producto actualizado correctamente');\n    } else {\n      // Modo nuevo ‚Üí comprobar si ya existe\n      const { data: existentes, error: fetchError } = await supabase\n        .from('productos')\n        .select('id, cantidad')\n        .eq('codigo_barras', productoParaGuardar.codigo_barras)\n        .eq('nombre', productoParaGuardar.nombre)\n\n      if (fetchError) {\n        console.error('‚ùå Error al buscar producto existente:', fetchError.message);\n        alert('‚ùå Error buscando productos existentes');\n        return;\n      }\n\n      if (existentes.length > 0) {\n        const productoExistente = existentes[0];\n        const nuevaCantidad = productoExistente.cantidad + productoParaGuardar.cantidad;\n        console.log('üß© Producto existente:', productoExistente);\n        const { error: updateError } = await supabase\n          .from('productos')\n          .update({ cantidad: nuevaCantidad })\n          .eq('id', productoExistente.id);\n\n        if (updateError) {\n          console.error('‚ùå Error al actualizar cantidad:', updateError.message);\n          alert('‚ùå Error al actualizar el producto');\n          return;\n        }\n\n\n        alert('‚úÖ Producto actualizado correctamente');\n      } else {\n        const { error: insertError } = await supabase\n          .from('productos')\n          .insert([productoParaGuardar]);\n\n        if (insertError) {\n          console.error('‚ùå Error al insertar:', insertError.message);\n          alert('‚ùå Error al guardar el producto');\n          return;\n        }\n\n        alert('‚úÖ Producto insertado correctamente');\n      }\n    }\n\n    if (onProductAdded) onProductAdded();\n\n    setProduct({\n      name: '',\n      barcode: '',\n      quantity: 1,\n      category: '',\n      location: '',\n      expiryDate: ''\n    });\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\n      <div>\n        <label className=\"block text-sm font-medium text-gray-700\">Nombre</label>\n        <input\n          type=\"text\"\n          name=\"name\"\n          value={product.name ?? ''}\n          onChange={handleChange}\n          required\n          className=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3\"\n        />\n      </div>\n\n      <div>\n        <label className=\"block text-sm font-medium text-gray-700\">C√≥digo de Barras</label>\n        <input\n          type=\"text\"\n          name=\"barcode\"\n          value={product.barcode ?? ''}\n          onChange={handleChange}\n          className=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3\"\n        />\n      </div>\n\n      <div>\n        <label className=\"block text-sm font-medium text-gray-700\">Cantidad</label>\n        <input\n          type=\"number\"\n          name=\"quantity\"\n          min=\"1\"\n          value={product.quantity ?? ''}\n          onChange={handleChange}\n          className=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3\"\n        />\n      </div>\n\n      <div>\n        <label className=\"block text-sm font-medium text-gray-700\">Categor√≠a</label>\n        <select\n          name=\"category\"\n          value={product.category ?? ''}\n          onChange={handleChange}\n          className=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3\"\n        >\n          <option value=\"\">Seleccione una categor√≠a</option>\n          {categorias.map((cat) => (\n            <option key={cat.id} value={cat.id}>{cat.nombre}</option>\n          ))}\n        </select>\n      </div>\n\n      <div>\n        <label className=\"block text-sm font-medium text-gray-700\">Ubicaci√≥n</label>\n        <select\n          name=\"location\"\n          value={product.location ?? ''}\n          onChange={handleChange}\n          className=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3\"\n        >\n          <option value=\"\">Seleccione una ubicaci√≥n</option>\n          {ubicaciones.map((ubi) => (\n            <option key={ubi.id} value={ubi.id}>{ubi.nombre}</option>\n          ))}\n        </select>\n      </div>\n\n      <div>\n        <label className=\"block text-sm font-medium text-gray-700\">Fecha de Caducidad</label>\n        <input\n          type=\"date\"\n          name=\"expiryDate\"\n          value={product.expiryDate ?? ''}\n          onChange={handleChange}\n          className=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3\"\n        />\n      </div>\n\n      <button\n        type=\"submit\"\n        className=\"w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700\"\n      >\n        {Inventario ? 'Actualizar Producto' : 'Agregar Producto'}\n      </button>\n    </form>\n  );\n};\n\nexport default AddProductForm;","import React, { useEffect, useState } from 'react';\nimport { supabase } from '../utils/supabaseClient';\n\nconst AddProductInventoryForm = ({ onProductAdded, codigoInicial = '' }) => {\n  const [product, setProduct] = useState({\n    name: '',\n    barcode: codigoInicial,\n    quantity: 1\n  });\n\n  const [loadingCatalog, setLoadingCatalog] = useState(false);\n  const [productoEnCatalogo, setProductoEnCatalogo] = useState(false);\n\n  // Buscar el producto en catalogo_productos si hay un c√≥digo escaneado\n  useEffect(() => {\n    const buscarEnCatalogo = async () => {\n      if (!codigoInicial || codigoInicial.trim() === '') {\n        setProductoEnCatalogo(false);\n        return;\n      }\n\n      setLoadingCatalog(true);\n      const { data, error } = await supabase\n        .from('catalogo_productos')\n        .select('nombre')\n        .eq('codigo_barras', codigoInicial)\n        .single();\n\n      if (error) {\n        console.log('üîç Producto no encontrado en cat√°logo. Se puede a√±adir manualmente.');\n        setProductoEnCatalogo(false);\n        setProduct(prev => ({\n          ...prev,\n          barcode: codigoInicial,\n          name: ''\n        }));\n      } else {\n        setProductoEnCatalogo(true);\n        setProduct(prev => ({\n          ...prev,\n          barcode: codigoInicial,\n          name: data.nombre\n        }));\n      }\n\n      setLoadingCatalog(false);\n    };\n\n    buscarEnCatalogo();\n  }, [codigoInicial]);\n\n  const handleChange = (e) => {\n    const { name, value } = e.target;\n    setProduct(prev => ({\n      ...prev,\n      [name]: name === 'quantity' ? parseInt(value) : value\n    }));\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    const productoParaGuardar = {\n      nombre: product.name,\n      codigo_barras: product.barcode,\n      cantidad: product.quantity\n    };\n\n    // 1. Buscar si ya existe en lista_compra\n    const { data: existente, error: errorBuscar } = await supabase\n      .from('lista_compra')\n      .select('*')\n      .eq('nombre', productoParaGuardar.nombre)\n      .eq('codigo_barras', productoParaGuardar.codigo_barras)\n      .single();\n\n    if (errorBuscar && errorBuscar.code !== 'PGRST116') {\n      // C√≥digo 116 = no se encontr√≥ nada, lo manejamos abajo\n      console.error('‚ùå Error al buscar producto existente:', errorBuscar.message);\n      alert('Error al comprobar duplicados');\n      return;\n    }\n\n    if (existente) {\n      // 2. Si existe ‚Üí actualizar cantidad\n      const nuevaCantidad = existente.cantidad + productoParaGuardar.cantidad;\n\n      const { error: errorUpdate } = await supabase\n        .from('lista_compra')\n        .update({ cantidad: nuevaCantidad })\n        .eq('id', existente.id);\n\n      if (errorUpdate) {\n        console.error('‚ùå Error al actualizar cantidad:', errorUpdate.message);\n        alert('Error al actualizar el producto existente');\n        return;\n      }\n      \n    } else {\n      // 3. Si no existe ‚Üí insertar nuevo producto en lista_compra\n      const { error: errorInsert } = await supabase\n        .from('lista_compra')\n        .insert([productoParaGuardar]);\n\n      if (errorInsert) {\n        console.error('‚ùå Error al insertar nuevo producto:', errorInsert.message);\n        alert('Error al a√±adir el producto');\n        return;\n      }\n    }\n\n    // 4. A√±adir a catalogo_productos si no est√° y SI tiene c√≥digo de barras.\n    if (!productoEnCatalogo && product.barcode && product.barcode.trim() !== '') {\n      const { error: errorCatalogo } = await supabase.from('catalogo_productos').insert([\n        {\n          nombre: product.name,\n          codigo_barras: product.barcode\n        }\n      ]);\n\n      if (errorCatalogo) {\n        console.error('‚ö†Ô∏è Error al guardar en cat√°logo:', errorCatalogo.message);\n        alert('‚ö†Ô∏è El producto se guard√≥ en la lista, pero no en el cat√°logo.');\n      }\n    }\n\n    if (onProductAdded) onProductAdded();\n    setProduct({ name: '', barcode: '', quantity: 1 });\n  };\n\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\n      {loadingCatalog && <p className=\"text-sm text-gray-500\">Buscando en el cat√°logo...</p>}\n\n      <div>\n        <label className=\"block text-sm font-medium text-gray-700\">Nombre</label>\n        <input\n          type=\"text\"\n          name=\"name\"\n          value={product.name}\n          onChange={handleChange}\n          required\n          className=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3\"\n          placeholder=\"Nombre del producto\"\n        />\n      </div>\n\n      <div>\n        <label className=\"block text-sm font-medium text-gray-700\">C√≥digo de Barras</label>\n        <input\n          type=\"text\"\n          name=\"barcode\"\n          value={product.barcode}\n          onChange={handleChange}\n          className=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3\"\n          placeholder=\"Ej: 8431234567890\"\n        />\n      </div>\n\n      <div>\n        <label className=\"block text-sm font-medium text-gray-700\">Cantidad</label>\n        <input\n          type=\"number\"\n          name=\"quantity\"\n          min=\"1\"\n          value={product.quantity}\n          onChange={handleChange}\n          className=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3\"\n        />\n      </div>\n\n      <button\n        type=\"submit\"\n        className=\"w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700\"\n      >\n        Agregar Producto\n      </button>\n    </form>\n  );\n};\n\nexport default AddProductInventoryForm;\n","import React from 'react';\nimport { Inventario } from '../components/Inventario';\n\nconst ProductItem = ({ product, onEdit, onDelete, onAddToShoppingList, onTogglePlus, onToggleMinus }) => {\n  const calculateDaysLeft = () => {\n    if (!product.fecha_caducidad) return null;\n    const expiry = new Date(product.fecha_caducidad);\n    const today = new Date();\n    const diffTime = expiry - today;\n    return Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n  };\n\n  const daysLeft = calculateDaysLeft();\n  let statusClass = '';\n  let statusText = '';\n\n  if (daysLeft !== null) {\n    if (daysLeft < 0) {\n      statusClass = 'bg-red-200 text-red-800';\n      statusText = 'Caducado';\n    } else if (daysLeft <= 3) {\n      statusClass = 'bg-yellow-200 text-yellow-800';\n      statusText = `Caduca en ${daysLeft} d√≠as`;\n    } else if (daysLeft <= 7) {\n      statusClass = 'bg-blue-200 text-blue-800';\n      statusText = `Caduca en ${daysLeft} d√≠as`;\n    }\n  }\n\n  return (\n    <div className=\"bg-white shadow rounded-lg p-4 mb-4\">\n      <div className=\"flex justify-between items-start\">\n        <div>\n          <h3 className=\"font-medium text-lg\">{product.nombre}</h3>\n          <div className=\"mt-4 flex space-x-2\">\n            <p className=\"text-gray-600\">Cantidad: </p>\n            <button\n              onClick={() => onToggleMinus(product)}\n              className=\"text-sm bg-yellow-500 text-white py-1 px-1 rounded hover:bg-yellow-600\"\n            >\n              ‚ûñ\n            </button>\n            <p>{product.cantidad}</p>\n            <button\n              onClick={() => onTogglePlus(product)}\n              className=\"text-sm bg-yellow-500 text-white py-1 px-1 rounded hover:bg-yellow-600\"\n            >\n              ‚ûï‚Äã\n            </button>\n          </div>\n          <p className=\"text-gray-600\">Categor√≠a: {product.categorias?.nombre}</p>\n          <p className=\"text-gray-600\">Ubicaci√≥n: {product.ubicaciones?.nombre}</p>\n          {product.fecha_caducidad && (\n            <p className=\"text-gray-600\">\n              Caduca: {new Date(product.fecha_caducidad).toLocaleDateString()}\n            </p>\n          )}\n        </div>\n        \n        {statusText && (\n          <span className={`px-2 py-1 text-xs font-semibold rounded-full ${statusClass}`}>\n            {statusText}\n          </span>\n        )}\n      </div>\n      \n      <div className=\"mt-4 justify-between flex space-x-2\">\n        <div className=\"mt-4 flex space-x-2\">\n          <button\n            onClick={() => onEdit(product)}\n            className=\"text-sm bg-blue-500 text-white py-1 px-3 rounded hover:bg-blue-600\"\n          >\n            Editar üìù\n          </button>\n          <button\n            onClick={() => onDelete(product.id)}\n            className=\"text-sm bg-red-500 text-white py-1 px-3 rounded hover:bg-red-600\"\n          >\n            Eliminar ‚ùå\n          </button>\n        </div>\n        <div className=\"mt-4 flex space-x-2 px-5\">\n          <button\n            onClick={() => onAddToShoppingList(product)}\n            className=\"text-sm bg-green-500 text-white py-1 px-3 rounded hover:bg-green-600\"\n          >\n            üõí\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ProductItem;","import React from 'react';\nimport { useListaCompra } from '../hook/useListaCompra';\n//import { supabase } from '../utils/supabaseClient';\n\nconst ShoppingListItem = ({product, onTogglePurchased, onTogglePlus, onToggleMinus}) => {\n  const { lista, loading } = useListaCompra();\n\n  if (loading) return <p>Cargando lista de la compra...</p>;\n  if (lista.length === 0) return <p>No hay productos en tu cesta.</p>;\n  return (\n       \n    <div className=\"bg-white shadow rounded-lg p-4 mb-4 border-l-4 border-green-500\">\n      <div className=\"flex justify-between items-start\">\n        <div>\n          <h3 className=\"font-medium text-lg\">{product.nombre}</h3>\n          <div className=\"mt-4 flex space-x-2\">\n            <p className=\"text-gray-600\">Cantidad:</p>\n            \n            <button\n              onClick={() => onToggleMinus(product)}\n              className=\"text-sm bg-yellow-500 text-white py-1 px-1 rounded hover:bg-yellow-600\"\n            >\n              ‚ûñ\n            </button>\n            <p>{product.cantidad}</p>\n            <button\n              onClick={() => onTogglePlus(product)}\n              className=\"text-sm bg-yellow-500 text-white py-1 px-1 rounded hover:bg-yellow-600\"\n            >\n              ‚ûï‚Äã\n            </button>\n            \n            \n          </div>\n        </div>\n      </div>\n      <div className=\"mt-4 flex space-x-2\">\n        <button\n          onClick={() => onTogglePurchased(product)}\n          className=\"text-sm bg-green-500 text-white py-1 px-3 rounded hover:bg-green-600\"\n        >\n          Comprado\n        </button>\n        \n      </div>\n    </div>\n  );\n};\n\nexport default ShoppingListItem;\n","// src/hook/useListaCompra.js\r\nimport { useEffect, useState } from 'react';\r\nimport { supabase } from '../utils/supabaseClient';\r\n\r\nexport const useListaCompra = () => {\r\n  const [lista, setLista] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const fetchLista = async () => {\r\n      setLoading(true);\r\n      const { data, error } = await supabase\r\n        .from('lista_compra')\r\n        .select('*')\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (error) {\r\n        console.error('Error al obtener lista de compra:', error.message);\r\n      } else {\r\n        setLista(data);\r\n      }\r\n      setLoading(false);\r\n    };\r\n\r\n    fetchLista();\r\n  }, []);\r\n\r\n  return { lista, loading };\r\n};\r\n","import React from 'react';\nimport { useCaducados } from '../hook/useCaducados';\n//import { supabase } from '../utils/supabaseClient';\n\nconst ExpiredProductItem = ({product, onDelete, onAddToShoppingList}) => {\n  const { caducados, loading} = useCaducados();\n\n\n\n  if (loading) return <p>Cargando productos caducados...</p>;\n  if (caducados.length === 0) return <p>No hay productos caducados.</p>;\n  //console.log('Renderizando producto:', product);\n  return (\n    \n    <div className=\"bg-white shadow rounded-lg p-4 mb-4 border-l-4 border-red-500\">\n      <div className=\"flex justify-between items-start\">\n        <div>\n          \n          <h3 className=\"font-medium text-lg\">{product.nombre}</h3>\n          <p className=\"text-gray-600\">Cantidad: {product.cantidad}</p>\n          <p className=\"text-gray-600\">Categor√≠a: {product.categorias.nombre}</p>\n          <p className=\"text-gray-600\">Ubicaci√≥n: {product.ubicaciones.nombre}</p>\n          {product.fecha_caducidad && (\n            <p className=\"text-gray-600\">\n              Caduc√≥ el:{' '}\n              {new Date(product.fecha_caducidad).toLocaleDateString()}\n            </p>\n          )}\n        </div>\n\n        <span className=\"px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800\">\n          Caducado\n        </span>\n      </div>\n      \n      <div className=\"mt-4 flex space-x-2\">\n        <button\n          onClick={() => onAddToShoppingList(product)}\n          className=\"text-sm bg-green-500 text-white py-1 px-3 rounded hover:bg-green-600\"\n        >\n          A√±adir a compras\n        </button>\n        <button\n          onClick={() => onDelete(product)}\n          className=\"text-sm bg-red-500 text-white py-1 px-3 rounded hover:bg-red-600\"\n        >\n          Eliminar\n        </button>\n      </div>\n    </div>\n  )\n};\n\nexport default ExpiredProductItem;\n\n","// src/hook/useCaducados.js\r\nimport { useState, useEffect } from 'react';\r\nimport { supabase } from '../utils/supabaseClient';\r\n\r\nexport const useCaducados = () => {\r\n  const [caducados, setCaducados] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const fetchCaducados = async () => {\r\n    // Solo continuar si no hemos cargado antes\r\n    if (caducados.length > 0) return;\r\n\r\n    setLoading(true);\r\n    const today = new Date().toISOString().split('T')[0];\r\n\r\n    // Consulta SOLO los productos caducados\r\n    const { data: dataCaducados, error: errorCaducados } = await supabase\r\n      .from('caducados')\r\n      .select('*');\r\n   \r\n    if (errorCaducados) {\r\n      console.error('Error al cargar productos caducados:', errorCaducados);\r\n      setCaducados([]);\r\n    } else {\r\n      setCaducados(dataCaducados);\r\n    }\r\n\r\n    setLoading(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchCaducados();\r\n  }, []);\r\n\r\n  return { caducados, loading, fetchCaducados, setCaducados };\r\n};\r\n\r\n","import React, { useState, useEffect } from 'react';\r\nimport { supabase } from '../utils/supabaseClient';\r\n\r\nexport const SettingsModal = ({ isOpen, onClose }) => {\r\n  const [newCategoria, setNewCategoria] = useState('');\r\n  const [newUbicacion, setNewUbicacion] = useState('');\r\n  const [categorias, setCategorias] = useState([]);\r\n  const [ubicaciones, setUbicaciones] = useState([]);\r\n\r\n  const fetchData = async () => {\r\n    const { data: categoriasData } = await supabase.from('categorias').select('*');\r\n    const { data: ubicacionesData } = await supabase.from('ubicaciones').select('*');\r\n    setCategorias(categoriasData || []);\r\n    setUbicaciones(ubicacionesData || []);\r\n  };\r\n  \r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n    if (isOpen) {\r\n      fetchData();\r\n    }\r\n  }, [isOpen]);\r\n\r\n  const handleAddCategoria = async () => {\r\n    if (newCategoria.trim() === '') return;\r\n    await supabase.from('categorias').insert([{ nombre: newCategoria.trim() }]);\r\n    setNewCategoria('');\r\n    fetchData();\r\n  };\r\n\r\n  const handleAddUbicacion = async () => {\r\n    if (newUbicacion.trim() === '') return;\r\n    await supabase.from('ubicaciones').insert([{ nombre: newUbicacion.trim() }]);\r\n    setNewUbicacion('');\r\n    fetchData();\r\n  };\r\n\r\n  const deleteCategoria = async (id) => {\r\n    await supabase.from('categorias').delete().eq('id', id);\r\n    fetchData();\r\n  };\r\n\r\n  const deleteUbicacion = async (id) => {\r\n    await supabase.from('ubicaciones').delete().eq('id', id);\r\n    fetchData();\r\n  };\r\n\r\n\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white rounded-lg shadow-lg w-full max-w-md max-h-[90vh] flex flex-col\">\r\n        {/* <button\r\n          onClick={onClose}\r\n          className=\"absolute top-2 right-2 text-gray-600 hover:text-black\"\r\n        >\r\n          ‚úï\r\n        </button>*/}\r\n        {/* Encabezado */}\r\n        <div className=\"flex justify-between items-center p-4 border-b\">\r\n          <h2 className=\"text-lg font-semibold text-gray-800\">Ajustes</h2>\r\n          <button onClick={onClose} className=\"text-gray-500 hover:text-red-600 text-xl font-bold\">\r\n            &times;\r\n          </button>\r\n        </div>\r\n        \r\n        {/* Contenido desplazable */}\r\n        <div className=\"overflow-y-auto p-4 space-y-4 flex-1\">\r\n          {/* Tu formulario de a√±adir categor√≠a/ubicaci√≥n y las listas existentes */}\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"overflow-y-auto p-4 space-y-4 flex-1\">\r\n              {/* A√±adir categor√≠a */}\r\n              <div className=\"mb-4\">\r\n                <label className=\"block mb-1 text-sm font-medium text-gray-700\">Nueva Categor√≠a</label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={newCategoria}\r\n                  onChange={(e) => setNewCategoria(e.target.value)}\r\n                  className=\"w-full border border-gray-300 rounded text-gray-700 px-3 py-2\"\r\n                />\r\n                <button\r\n                  onClick={handleAddCategoria}\r\n                  className=\"mt-2 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700\"\r\n                >\r\n                  A√±adir Categor√≠a\r\n                </button>\r\n              </div>\r\n\r\n              {/* Lista de categor√≠as */}\r\n              <h3 className=\"text-md font-semibold text-gray-700 mt-4 mb-1\">Categor√≠as existentes</h3>\r\n              <ul className=\"space-y-1 mb-4\">\r\n                {categorias.map((cat) => (\r\n                  <li key={cat.id} className=\"flex justify-between text-gray-700 items-center border-b py-1\">\r\n                    <span className='px-2'>{cat.nombre}</span>\r\n                    <button\r\n                      onClick={() => deleteCategoria(cat.id)}\r\n                      className=\"text-red-500 hover:text-red-700 text-sm\"\r\n                    >\r\n                      Eliminar\r\n                    </button>\r\n                  </li>\r\n                ))}\r\n              </ul>\r\n            </div>\r\n            <div className=\"overflow-y-auto p-4 space-y-4 flex-1\">\r\n              {/* A√±adir ubicaci√≥n */}\r\n              <div className=\"mb-4\">\r\n                <label className=\"block mb-1 text-sm font-medium text-gray-700\">Nueva Ubicaci√≥n</label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={newUbicacion}\r\n                  onChange={(e) => setNewUbicacion(e.target.value)}\r\n                  className=\"w-full border border-gray-300 text-gray-700 rounded px-3 py-2\"\r\n                />\r\n                <button\r\n                  onClick={handleAddUbicacion}\r\n                  className=\"mt-2 bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700\"\r\n                >\r\n                  A√±adir Ubicaci√≥n\r\n                </button>\r\n              </div>\r\n\r\n              {/* Lista de ubicaciones */}\r\n              <h3 className=\"text-md font-semibold text-gray-700 mt-4 mb-1\">Ubicaciones existentes</h3>\r\n              <ul className=\"space-y-1\">\r\n                {ubicaciones.map((ubi) => (\r\n                  <li key={ubi.id} className=\"flex justify-between text-gray-700 items-center border-b py-1\">\r\n                    <span className='px-2'>{ubi.nombre}</span>\r\n                    <button\r\n                      onClick={() => deleteUbicacion(ubi.id)}\r\n                      className=\"text-red-500 hover:text-red-700 text-sm\"\r\n                    >\r\n                      Eliminar\r\n                    </button>\r\n                  </li>\r\n                ))}\r\n              </ul>\r\n            </div>\r\n          </div>\r\n          \r\n        </div>\r\n\r\n        \r\n        {/* Pie opcional */}\r\n        <div className=\"p-2 border-t text-center text-sm text-gray-400\">\r\n          ¬© SmartFridge\r\n        </div>\r\n      </div>\r\n    </div> \r\n        \r\n  );\r\n};\r\n\r\n","import React, { useState, useEffect } from 'react';\r\nimport { supabase } from '../utils/supabaseClient';\r\n\r\n// Quita acentos, s√≠mbolos y pasa a min√∫sculas\r\nconst normalize = (str) =>\r\n  str\r\n    .normalize(\"NFD\")\r\n    .replace(/[\\u0300-\\u036f]/g, \"\")\r\n    .toLowerCase();\r\n\r\n// Fuzzy simple: admite errores leves (1 letra mal)\r\nconst fuzzyMatch = (text, search) => {\r\n  if (!text || !search) return false;\r\n\r\n  text = normalize(text);\r\n  search = normalize(search);\r\n\r\n  // Coincidir si contiene directamente\r\n  if (text.includes(search)) return true;\r\n\r\n  // Permitir distancia de edici√≥n de 1\r\n  const maxDist = 1;\r\n  const dp = Array(search.length + 1)\r\n    .fill(null)\r\n    .map(() => Array(text.length + 1).fill(null));\r\n\r\n  for (let i = 0; i <= search.length; i++) dp[i][0] = i;\r\n  for (let j = 0; j <= text.length; j++) dp[0][j] = j;\r\n\r\n  for (let i = 1; i <= search.length; i++) {\r\n    for (let j = 1; j <= text.length; j++) {\r\n      const costo = search[i - 1] === text[j - 1] ? 0 : 1;\r\n\r\n      dp[i][j] = Math.min(\r\n        dp[i - 1][j] + 1,       // eliminaci√≥n  \r\n        dp[i][j - 1] + 1,       // inserci√≥n  \r\n        dp[i - 1][j - 1] + costo // sustituci√≥n  \r\n      );\r\n    }\r\n  }\r\n\r\n  return dp[search.length][text.length] <= maxDist;\r\n};\r\n\r\nconst ProductSearchBar = ({ onResults }) => {\r\n  const [query, setQuery] = useState('');\r\n  const [categoriaId, setCategoriaId] = useState('');\r\n  const [ubicacionId, setUbicacionId] = useState('');\r\n  const [categorias, setCategorias] = useState([]);\r\n  const [ubicaciones, setUbicaciones] = useState([]);\r\n\r\n\r\n  useEffect(() => {\r\n    const fetchFilters = async () => {\r\n      const { data: cat } = await supabase.from('categorias').select('*');\r\n      const { data: ubi } = await supabase.from('ubicaciones').select('*');\r\n      setCategorias(cat);\r\n      setUbicaciones(ubi);\r\n    };\r\n    fetchFilters();\r\n  }, []);\r\n\r\n  const handleSearch = async () => {\r\n    const cleanedQuery = query.trim();\r\n\r\n    // ‚õî Si el usuario no escribi√≥ nada ‚Üí mandar aviso especial\r\n    if (cleanedQuery === \"\") {\r\n      onResults(null, null, \"\");\r\n      return;\r\n    }\r\n\r\n    // üîç Buscar en inventario\r\n    let queryBase = supabase\r\n      .from('productos')\r\n      .select('*, categorias(nombre), ubicaciones(nombre)')\r\n      .or(`nombre.ilike.%${cleanedQuery}%,codigo_barras.ilike.%${cleanedQuery}%`);\r\n\r\n    if (categoriaId) queryBase = queryBase.eq('categoria_id', categoriaId);\r\n    if (ubicacionId) queryBase = queryBase.eq('ubicacion_id', ubicacionId);\r\n\r\n    const { data: productos, error } = await queryBase;\r\n    if (error) return alert('‚ùå Error buscando productos');\r\n\r\n    // Buscar en cat√°logo\r\n    const { data: enCatalogo, error: errorCatalogo } = await supabase\r\n      .from('catalogo_productos')\r\n      .select('*')\r\n      .or(`nombre.ilike.%${cleanedQuery}%,codigo_barras.ilike.%${cleanedQuery}%`);\r\n\r\n    if (errorCatalogo) return alert('‚ùå Error al buscar en el cat√°logo');\r\n\r\n    // Enviar ambos resultados\r\n    onResults(productos, enCatalogo);\r\n  };\r\n\r\n  const handleClear = () => {\r\n    setQuery(\"\");               // Limpia el input\r\n    onResults([], [], \"\");           // Devuelve b√∫squeda vac√≠a a App\r\n  };\r\n\r\n\r\n  return (\r\n    <div className=\"flex flex-col md:flex-row gap-2 mb-4 fill-width\" >\r\n      <div style={{ position: \"relative\", display: \"flex\", alignItems: \"center\", width: \"100%\", height: \"100%\" }}>\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Buscar por nombre o c√≥digo de barras\"\r\n          value={query}\r\n          onChange={(e) => setQuery(e.target.value)}\r\n          className=\"border px-3 py-4 rounded w-full\"\r\n          onKeyDown={(e) => {\r\n            if (e.key === \"Enter\") {\r\n              handleSearch();  // Llama a la misma funci√≥n del bot√≥n\r\n            }\r\n          }}          \r\n        />\r\n        {query && (\r\n            <button\r\n              onClick={handleClear}\r\n              style={{\r\n                position: \"absolute\",\r\n                right: \"8px\",\r\n                background: \"transparent\",\r\n                border: \"none\",\r\n                cursor: \"pointer\",\r\n                fontSize: \"18px\",\r\n                color: \"#999\",\r\n              }}\r\n            >\r\n              ‚úï\r\n            </button>\r\n          )}\r\n      </div>\r\n      <select\r\n        value={categoriaId}\r\n        onChange={(e) => setCategoriaId(e.target.value)}\r\n        className=\"border px-3 py-2 rounded\"\r\n      >\r\n        <option value=\"\">Todas las categor√≠as</option>\r\n        {categorias.map(c => <option key={c.id} value={c.id}>{c.nombre}</option>)}\r\n      </select>\r\n      <select\r\n        value={ubicacionId}\r\n        onChange={(e) => setUbicacionId(e.target.value)}\r\n        className=\"border px-3 py-2 rounded\"\r\n      >\r\n        <option value=\"\">Todas las ubicaciones</option>\r\n        {ubicaciones.map(u => <option key={u.id} value={u.id}>{u.nombre}</option>)}\r\n      </select>\r\n      <button \r\n        onClick={handleSearch} \r\n        className=\"text-sm bg-blue-500 text-white py-2 px-3 rounded hover:bg-blue-600\"\r\n      >\r\n        Buscar üîç\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProductSearchBar;\r\n\r\n","import React, { useState, useEffect } from 'react';\nimport ScanBarcodeButton from './components/ScanBarcodeButton';\nimport AddProductForm from './components/AddProductForm';\nimport AddProductInventoryForm from './components/AddProductInventoryForm';\nimport ProductItem from './components/ProductItem';\nimport ShoppingListItem from './components/ShoppingListItem';\nimport ExpiredProductItem from './components/ExpiredProductItem';\nimport { SettingsModal } from './components/SettingsModal';\nimport { supabase } from './utils/supabaseClient';\nimport ProductSearchBar from './components/ProductSearchBar';\n\n\n\n\nconst App = () => {\n  const [products, setProducts] = useState([]);\n  const [shoppingList, setShoppingList] = useState([]);\n  const [expiredProducts, setExpiredProducts] = useState([]);\n  const [activeTab, setActiveTab] = useState('inventory');\n  const [showAddForm, setShowAddForm] = useState(false);\n  const [editingProduct, setEditingProduct] = useState(null);\n  const [showAddInventoryForm, setShowAddInventoryForm] = useState(false);\n  const [editingProductShopping, setEditingProductShopping] = useState(null);\n  const [codigoEscaneado, setCodigoEscaneado] = useState('');\n\n\n  \n  const fetchProducts = async () => {\n    const { data, error } = await supabase.from('productos').select(\"id, nombre, codigo_barras, cantidad, fecha_caducidad, categorias (nombre), ubicaciones (nombre)\");\n    if (!error) {\n      setProducts(data);\n    }\n  };\n\n  const fetchExpiredProducts = async () => {\n    const { data, error } = await supabase\n      .from('caducados')\n      .select(\"id, nombre, cantidad, fecha_caducidad, categorias (nombre), ubicaciones (nombre)\");\n\n    if (!error) {\n      setExpiredProducts(data);\n    }\n  };\n\n  const fetchShoppingList = async () => {\n    const { data, error } = await supabase\n      .from('lista_compra')\n      .select(\"*\");\n\n    if (!error) {\n      setShoppingList(data);\n    }\n  };\n\n  useEffect(() => {\n    if (activeTab === 'shopping') fetchShoppingList();\n    if (activeTab === 'inventory') fetchProducts();\n    if (activeTab === 'expired') fetchExpiredProducts();\n  }, [activeTab]);\n\n\n  /*\n  if (activeTab === 'shopping'){\n    fetchShoppingList();\n  }\n  if (activeTab === 'inventory'){\n    fetchProducts();\n  }\n  if (activeTab === 'expired'){\n    fetchExpiredProducts();\n  }*/\n\n  useEffect(() => {\n    fetchProducts();\n    fetchExpiredProducts();\n    fetchShoppingList();\n    revisarProductosCaducados();\n  }, []);\n\n  // Efecto para manejar productos caducados\n  \n  const revisarProductosCaducados = async () => {\n    const now = new Date();\n\n    const { data: productos, error } = await supabase\n      .from('productos')\n      .select('*');\n\n    if (error) {\n      console.error('Error al obtener productos:', error.message);\n      return;\n    }\n\n    const caducados = productos.filter(p => new Date(p.fecha_caducidad) < now);\n    //const vigentes = productos.filter(p => new Date(p.fecha_caducidad) >= now);\n\n    // Eliminar los caducados del inventario\n    for (const producto of caducados) {\n      await supabase.from('productos').delete().eq('id', producto.id);\n    }\n\n    // Agregarlos a 'lista_compra' y 'caducados'\n    const nuevoId = Date.now().toString();\n    \n\n    for (const producto of caducados) {\n      // Obtener nombre de categor√≠a\n      const { data: categoriaData } = await supabase\n        .from('categorias')\n        .select('nombre')\n        .eq('id', producto.categoria_id)\n        .single();\n\n      //const categoriaNombre = categoriaData?.nombre || '';\n\n      // Obtener nombre de ubicaci√≥n\n      const { data: ubicacionData } = await supabase\n        .from('ubicaciones')\n        .select('nombre')\n        .eq('id', producto.ubicacion_id)\n        .single();\n\n      //const ubicacionNombre = ubicacionData?.nombre || '';\n\n      const { data: existe, error: errorExiste } = await supabase\n        .from('lista_compra')\n        .select('id')\n        .eq('codigo_barras', producto.codigo_barras)\n        .eq('es_caducado', true)\n        .maybeSingle();\n\n      if (!existe) {\n        \n        await supabase.from('lista_compra').insert([{\n          id: nuevoId,\n          ...producto,\n          es_caducado: true,\n        }]);\n      }\n\n\n      // Insertar en caducados\n      const yaExiste = await supabase\n        .from('caducados')\n        .select('id')\n        .eq('nombre', producto.nombre)\n        .eq('codigo_barras', producto.codigo_barras)\n        .eq('fecha_caducidad', producto.fecha_caducidad);\n\n      if (yaExiste.data.length === 0) {\n        await supabase.from('caducados').insert({\n          nombre: producto.nombre,\n          cantidad: producto.cantidad,\n          codigo_barras: producto.codigo_barras,\n          fecha_caducidad: producto.fecha_caducidad,\n          categoria_id: producto.categoria_id,\n          ubicacion_id: producto.ubicacion_id\n      });\n      }\n    }\n\n    // Recarga de estado tras limpieza\n    fetchProducts();\n    fetchExpiredProducts();\n    fetchShoppingList();\n  };\n\n\n  const handleScan = (barcode) => {\n    setShowAddForm(true);\n    setEditingProduct({\n      name: '',\n      barcode,\n      quantity: 1,\n      category: 'otros',\n      location: 'despensa-estante1',\n      expiryDate: ''\n    });\n  };\n\n  const handleAddProduct = (newProduct) => {\n    if (editingProduct && editingProduct.id) {\n      // Actualizar producto existente\n      setProducts(products.map(p => \n        p.id === editingProduct.id ? { ...newProduct, id: editingProduct.id } : p\n      ));\n    } else {\n      // A√±adir nuevo producto\n      setProducts([...products, { ...newProduct, id: Date.now().toString() }]);\n    }\n    fetchProducts();\n    setShowAddForm(false);\n    setEditingProduct(null);\n    revisarProductosCaducados();\n  };\n\n  const handleScanShopping = (codigo) => {\n    setCodigoEscaneado(codigo);\n    setShowAddInventoryForm(true);\n  };\n  \n  const handleAddInventoryProduct = (newProduct) => {\n    if (editingProductShopping && editingProductShopping.id) {\n      // Actualizar producto existente\n      setProducts(products.map(p => \n        p.id === editingProductShopping.id ? { ...newProduct, id: editingProductShopping.id } : p\n      ));\n    } else {\n    // A√±adir nuevo producto a la lista de la compra.\n    setProducts([...products, { ...newProduct, id: Date.now().toString() }]);\n    }\n    fetchShoppingList();\n    setEditingProductShopping(null);\n    setShowAddInventoryForm(false);\n  };\n\n  const handleEditProduct = (producto) => {\n    console.log('üìù Editando producto:', producto);\n    setEditingProduct({\n      id: producto.id,               // üëà\n      name: producto.nombre,\n      barcode: producto.codigo_barras,\n      quantity: producto.cantidad,\n      expiryDate: producto.fecha_caducidad,\n      category: producto.categoria_id,\n      location: producto.ubicacion_id\n    });\n    setShowAddForm(true);\n    // üëá Scroll al principio de la p√°gina\n    setTimeout(() => {\n      window.scrollTo({ top: 0, behavior: 'smooth' });\n    }, 100); // esperar a que se muestre el formulario\n  };\n\n\n  const handleDeleteProduct = async (productId) => {\n    const { error } = await supabase\n    .from('productos')\n    .delete()\n    .eq('id', productId);\n\n    if (error) {\n      console.error('‚ùå Error al eliminar producto:', error.message);\n      alert('‚ùå No se pudo eliminar el producto');\n    } else {\n      // Eliminarlo del estado para actualizar la vista\n      setProducts((prevProducts) => prevProducts.filter(p => p.id !== productId));\n      setSearchResults((prev) => {\n        if (!prev) return prev;   // por si est√° null al cargar\n        return prev.filter(p => p.id !== productId);\n      });\n\n      // 3Ô∏è‚É£ Actualizar coincidencias de cat√°logo si las usas\n      setCatalogMatch((prev) => {\n        if (!prev) return prev;\n        return prev.filter(p => p.id !== productId);\n      });\n    }\n    fetchProducts();\n  };\n  \n\n  const handleDeleteExpiredProduct = async (product) => {\n    const { error } = await supabase\n      .from('caducados')\n      .delete()\n      .eq('id', product.id);\n\n    if (!error) {\n      setExpiredProducts(prev => prev.filter(p => p.id !== product.id));\n    }\n    fetchExpiredProducts();\n  };\n\n  const normalizarProductoParaLista = (p) => ({\n    nombre: p.nombre,\n    cantidad: p.cantidad ?? 1,\n    codigo_barras: p.codigo_barras ?? null,\n    fecha_caducidad: p.fecha_caducidad ?? null,\n    categoria_id: p.categoria_id ?? p.categorias?.id ?? null,\n    ubicacion_id: p.ubicacion_id ?? p.ubicaciones?.id ?? null,\n    es_caducado: false\n  });\n\n  const handleAddToShoppingList = async (product) => {\n    const item = normalizarProductoParaLista(product);\n\n    console.log(\"Normalizado:\", item);\n\n    const { error } = await supabase\n      .from('lista_compra')\n      .insert(item);\n\n    if (error) {\n      console.error(\"‚ùå Error al insertar en lista_compra:\", error);\n      alert(\"‚ùå No se pudo a√±adir el producto\");\n    } else {\n      fetchShoppingList();\n    }\n  };\n\n\n  /*const handleAddToShoppingList = async (product) => {\n    const yaExiste = await supabase\n      .from('caducados')\n      .select('id')\n      .eq('nombre', product.nombre)\n      .eq('codigo_barras', product.codigo_barras)\n      .eq('fecha_caducidad', product.fecha_caducidad);\n\n    if (yaExiste.data.length === 0) {\n      await supabase.from('lista_compra').insert({\n        nombre: product.nombre,\n        cantidad: product.cantidad,\n        codigo_barras: product.codigo_barras,\n        fecha_caducidad: product.fecha_caducidad,\n        categoria_id: product.categoria_id,\n        ubicacion_id: product.ubicacion_id,\n        creado: product.created_at,\n        //es_caducado: true\n      });\n    }\n  };\n  */\n\n  const handleAddManualItem = () => {\n    setShowAddInventoryForm(true);\n  };\n\n\n  const handleTogglePurchased = async (product) => {\n    const { error } = await supabase\n      .from('lista_compra')\n      .delete()\n      .eq('id', product.id);\n    if (!error) {\n    setShoppingList(shoppingList.filter(i => i.id !== product.id));\n    }\n    fetchShoppingList();\n  };\n\n  //A√±adir y Eliminar cantidades para la lista de la compra.\n  const handleAddQuantity = async (product) => {\n    const { error } = await supabase\n      .from('lista_compra')\n      .update({ cantidad: product.cantidad + 1})\n      .eq('id', product.id);\n    if (!error) {\n    setShoppingList(shoppingList.filter(i => i.id !== product.id));\n    }\n    fetchShoppingList();\n  };\n\n  const handleSubstractQuantity = async (product) => {\n    const { error } = await supabase\n      .from('lista_compra')\n      .update({ cantidad: product.cantidad - 1})\n      .eq('id', product.id);\n    if (!error) {\n    setShoppingList(shoppingList.filter(i => i.id !== product.id));\n    }\n    if (product.cantidad === 1){\n      const { error } = await supabase\n      .from('lista_compra')\n      .delete()\n      .eq('id', product.id);\n    if (!error) {\n    setShoppingList(shoppingList.filter(i => i.id !== product.id));\n    }\n    }\n    fetchShoppingList();\n  };\n\n  //A√±adir y eliminar cantidades para el inventario.\n  const handleAddQuantityInventario = async (product) => {\n    const nuevaCantidad = product.cantidad + 1;\n    const { error } = await supabase\n      .from('productos')\n      .update({ cantidad: nuevaCantidad})\n      .eq('id', product.id);\n    if (!error) {\n      //alert('‚ùå No se pudo a√±adir la cantidad');\n      setProducts(products.map(p =>\n        p.id === product.id ? { ...p, cantidad: nuevaCantidad } : p\n      ));\n\n      if (searchResults.length > 0) {\n        const nuevosResultados = searchResults.map(p =>\n          p.id === product.id ? { ...p, cantidad: nuevaCantidad } : p\n        );\n        setSearchResults(nuevosResultados);\n      }\n    }\n    fetchProducts();\n  };\n\n  const handleSubstractQuantityInventario = async (product) => {\n    const nuevaCantidad = product.cantidad - 1;\n    const { error } = await supabase\n      .from('productos')\n      .update({ cantidad: nuevaCantidad})\n      .eq('id', product.id);\n      if (!error) {\n        \n        //alert('‚ùå No se pudo restar la cantidad');\n        setProducts(products.map(p =>\n          p.id === product.id ? { ...p, cantidad: nuevaCantidad } : p\n        ));\n\n        if (searchResults.length > 0) {\n          const nuevosResultados = searchResults.map(p =>\n            p.id === product.id ? { ...p, cantidad: nuevaCantidad } : p\n          );\n          setSearchResults(nuevosResultados);\n        }\n      }\n      if (product.cantidad === 1){\n        const { error } = await supabase\n        .from('productos')\n        .delete()\n        .eq('id', product.id);\n      if (!error) {\n        //alert('‚ùå No se pudo eliminar la cantidad');\n        setProducts(products.filter(i => i.id !== product.id));\n      }\n    }\n    fetchProducts();\n  };\n\n  const [mostrarAjustes, setMostrarAjustes] = useState(false);\n  \n  //Barra de b√∫squeda\n  const [searchResults, setSearchResults] = useState([]);\n  const [catalogMatch, setCatalogMatch] = useState(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [buscarVacio, setBuscarVacio] = useState(false);\n\n  const handleAddCatalogProductToShoppingList = async () => {\n    if (!catalogMatch) return;\n\n    const { error } = await supabase.from('lista_compra').insert({\n      nombre: catalogMatch.nombre,\n      cantidad: 1,\n      codigo_barras: catalogMatch.codigo_barras,\n      categoria_id: catalogMatch.categoria_id,\n      ubicacion_id: catalogMatch.ubicacion_id,\n      es_caducado: false\n    });\n\n    if (error) {\n      console.error('‚ùå Error al a√±adir desde cat√°logo:', error.message);\n      alert('‚ùå No se pudo a√±adir el producto desde el cat√°logo.');\n    } else {\n      alert(`‚úÖ A√±adido \"${catalogMatch.nombre}\" a la lista de la compra`);\n      fetchShoppingList(); // refrescar la lista\n      setCatalogMatch(null); // limpia la sugerencia\n      setSearchResults([]);  // limpia los resultados\n    }\n  };\n\n\n  useEffect(() => {\n    if (buscarVacio) {\n      const timer = setTimeout(() => {\n        setBuscarVacio(false);\n      }, 3000);\n\n      return () => clearTimeout(timer);\n    }\n  }, [buscarVacio]);\n\n\n\n  return (\n    <div className=\"min-h-screen bg-gray-800 p-4\">\n      <div className=\"max-w-6xl mx-auto bg-white rounded-lg shadow overflow-hidden\">\n        <div className=\"p-4 bg-blue-600 text-white\">\n          <div className=\"flex items-center justify-between\">\n            <h1 className=\"text-2xl font-bold\">SmartFridge</h1>\n            <button\n              onClick={() => setMostrarAjustes(true)}\n              className=\"bg-gray-700 text-white px-3 py-2 rounded hover:bg-gray-700\"\n            >\n              ‚öôÔ∏è Ajustes\n            </button>\n          </div>\n          \n          <p className=\"text-blue-100\">Control total de tu cocina</p>\n          \n          \n\n          {mostrarAjustes && <SettingsModal onClose={() => setMostrarAjustes(false)} />}\n          \n        </div>\n        \n        <div className=\"flex border-b\">\n          <button\n            className={`flex-1 py-2 px-4 font-medium ${activeTab === 'inventory' ? 'text-blue-600 border-b-2 border-blue-600' : 'text-gray-600'}`}\n            onClick={() => setActiveTab('inventory')}\n          >\n            Inventario üìã‚Äã\n          </button>\n          <button\n            className={`flex-1 py-2 px-4 font-medium ${activeTab === 'shopping' ? 'text-blue-600 border-b-2 border-blue-600' : 'text-gray-600'}`}\n            onClick={() => setActiveTab('shopping')}\n          >\n            Lista de la compra üõí\n          </button>\n          <button\n            className={`flex-1 py-2 px-4 font-medium ${activeTab === 'expired' ? 'text-blue-600 border-b-2 border-blue-600' : 'text-gray-600'}`}\n            onClick={() => setActiveTab('expired')}\n          >\n            Caducados ({expiredProducts.length}) ‚ò£Ô∏è‚Äã\n          </button>\n        </div>\n        \n        <div className=\"p-4\">\n          {activeTab === 'inventory' ? (\n            <>\n              <div>\n                <ProductSearchBar onResults={(resultados, catalogoArray, termino) => {\n                  setSearchResults(Array.isArray(resultados) ? resultados : []);\n                  setCatalogMatch(Array.isArray(catalogoArray) ? catalogoArray : []);\n                  setSearchTerm(termino); //guarda el t√©rmino para futuras refiltraciones\n                \n                  if (termino === \"\" && resultados === null) {\n                    setBuscarVacio(true);\n                  } else {\n                    setBuscarVacio(false);\n                  }\n                }} />\n                {buscarVacio && (\n                  <div className=\"bg-yellow-100 text-yellow-800 border-l-4 border-yellow-500 p-3 rounded my-3 shadow\">\n                    ‚ö†Ô∏è Por favor, escribe un texto para buscar un producto.\n                  </div>\n                )}\n\n              </div>\n              <div className=\"flex space-x-2 mb-4\">\n                <ScanBarcodeButton onScan={handleScan} />\n                <button\n                  onClick={() => {\n                    setShowAddForm(true);\n                    setEditingProduct(null);\n                    fetchProducts();\n                  }}\n                  className=\"bg-green-500 text-white py-2 px-4 rounded-lg hover:bg-green-600 transition-colors\"\n                >\n                  A√±adir Manualmente\n                </button>\n              </div>\n              \n              {showAddForm && (\n                <div className=\"mb-6 p-4 border rounded-lg bg-gray-50\">\n                  <AddProductForm onProductAdded={handleAddProduct} \n                    Inventario={editingProduct} \n                  />\n\n                  <button\n                    onClick={() => {\n                      setShowAddForm(false);\n                      setEditingProduct(null);\n                      fetchProducts();\n                    }}\n                    className=\"mt-2 text-sm text-gray-600 hover:text-gray-800\"\n                  >\n                    Cancelar\n                  </button>\n                </div>\n              )}\n              \n              <div className=\"space-y-4\">\n                {Array.isArray(catalogMatch) && catalogMatch.length > 0 && (\n                  <div>\n                    <p className=\"text-yellow-600 font-semibold mt-2\">\n                      Los siguientes productos est√°n agotados:\n                    </p>\n\n                    <ul className=\"mt-2 space-y-2\">\n                      {catalogMatch.map((prod) => (\n                        <li key={prod.id} className=\"flex items-center justify-between bg-yellow-100 p-2 rounded\">\n                          <span>{prod.nombre}</span>\n                          <button\n                            onClick={async () => {\n                              const { error } = await supabase.from('lista_compra').insert({\n                                nombre: prod.nombre,\n                                cantidad: 1,\n                                codigo_barras: prod.codigo_barras,\n                                categoria_id: prod.categoria_id,\n                                ubicacion_id: prod.ubicacion_id,\n                                es_caducado: false\n                              });\n\n                              if (!error) {\n                                alert(`‚úÖ A√±adido \"${prod.nombre}\" a la lista de la compra`);\n                                fetchShoppingList();\n                              } else {\n                                alert('‚ùå Error al a√±adir a la lista de la compra');\n                              }\n                            }}\n                            className=\"text-sm bg-blue-500 text-white py-1 px-3 rounded hover:bg-blue-600\"\n                          >\n                            A√±adir üõí\n                          </button>\n                        </li>\n                      ))}\n                    </ul>\n                  </div>\n                )}\n\n                {(searchResults.length > 0 ? searchResults : products).length === 0 ? (\n                  <p className=\"text-gray-500\">No hay productos en tu inventario. ¬°A√±ade algunos!</p>\n                ) : (\n                  (searchResults.length > 0 ? searchResults : products).map(product => (\n                    <ProductItem\n                      key={product.id}\n                      product={product}\n                      onEdit={handleEditProduct}\n                      onDelete={handleDeleteProduct}\n                      onAddToShoppingList={handleAddToShoppingList}\n                      onTogglePlus={handleAddQuantityInventario}\n                      onToggleMinus={handleSubstractQuantityInventario}\n                    />\n                  ))\n                )}\n\n                \n              </div>\n            </>\n          ) : activeTab === 'shopping' ? (\n            <>\n              <div className=\"flex space-x-2 mb-4\">\n                <ScanBarcodeButton onScan={(code) => {\n                  setCodigoEscaneado(code);\n                  setShowAddInventoryForm(true);\n                }} />\n                <button\n                  onClick={() => {\n                    setShowAddInventoryForm(true);\n                    setCodigoEscaneado('');\n                    setEditingProductShopping(null);\n                    fetchShoppingList();\n                  }}\n                  className=\"bg-green-500 text-white py-2 px-4 rounded-lg hover:bg-green-600 transition-colors\"\n                >\n                  A√±adir Producto\n                </button>\n              </div>\n              {showAddInventoryForm && (\n                <div className=\"mb-6 p-4 border rounded-lg bg-gray-50\">\n                  <AddProductInventoryForm\n                    codigoInicial={codigoEscaneado}\n                    onProductAdded={() => {\n                      setShowAddInventoryForm(false);\n                      setCodigoEscaneado('');\n                      fetchShoppingList(); // si quieres refrescar despu√©s de a√±adir\n                    }}\n                  />\n                  <button\n                    onClick={() => {\n                      setShowAddInventoryForm(false);\n                      fetchShoppingList();\n                    }}\n                    className=\"mt-2 text-sm text-gray-600 hover:text-gray-800\"\n                  >\n                    Cancelar\n                  </button>\n                </div>\n              )}\n              <div className=\"space-y-4\">\n                \n                {shoppingList.length === 0 ? (\n                  <p className=\"text-gray-500\">Tu lista de la compra est√° vac√≠a. ¬°A√±ade algunos productos!</p>\n                ) : (\n                  shoppingList.map(product => (\n                    <ShoppingListItem\n                      key={product.id}\n                      product={product}\n                      onTogglePurchased={handleTogglePurchased}\n                      onTogglePlus={handleAddQuantity}\n                      onToggleMinus={handleSubstractQuantity}\n                    />\n                  ))\n                )}\n              </div>\n            </>\n          ) : (\n            <>\n              <h2 className=\"text-xl font-semibold mb-4\">Productos Caducados</h2>\n              \n              <div className=\"space-y-4\">\n                {expiredProducts.length === 0 ? (\n                  <p className=\"text-gray-500\">¬°Genial! No tienes productos caducados.</p>\n                ) : (\n                  \n                  expiredProducts.map(product => (\n                    <ExpiredProductItem\n                      key={product.id}\n                      product={product}\n                      onDelete={handleDeleteExpiredProduct}\n                      onAddToShoppingList={handleAddToShoppingList}\n                    />\n                  ))\n                )}\n              </div>\n            </>\n          )}\n        </div>\n        {/* Pie opcional */}\n        <div className=\"p-2 border-t text-center text-sm text-gray-400\">\n          ¬© SmartFridge\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default App;","import React, { StrictMode } from \"react\";\nimport { createRoot } from \"react-dom/client\";\nimport \"./styles.css\";\n\nimport App from \"./App\";\n\nconst root = createRoot(document.getElementById(\"root\"));\nroot.render(\n  //<StrictMode>\n  <App />\n  //</StrictMode>\n);"],"sourceRoot":""}